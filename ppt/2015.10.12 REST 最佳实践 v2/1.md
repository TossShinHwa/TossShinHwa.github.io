# REST 最佳实践



### 历史 <!-- .element: class="fragment grow highlight-blue" data-fragment-index="1" -->
### 定义
### 规范
### 案例


## Code
* DB First <!-- .element: class="fragment highlight-current-red" data-fragment-index="1" -->
* Model First <!-- .element: class="fragment highlight-current-red" data-fragment-index="2" -->
* API First <!-- .element: class="fragment highlight-current-red" data-fragment-index="3" -->


## API
* SOAP  - Simple Object Access Protocol <!-- .element: class="fragment highlight-current-red" data-fragment-index="1" -->
* RPC   - Remote Procedure Call <!-- .element: class="fragment highlight-current-red" data-fragment-index="2" -->
* REST  - REpresentational State Transfer <!-- .element: class="fragment highlight-current-red" data-fragment-index="3" -->
* OData  - Open Data Protocol <!-- .element: class="fragment highlight-current-red" data-fragment-index="4" -->

![img](1.jpg)



### 历史
### 定义 <!-- .element: class="fragment grow highlight-blue" data-fragment-index="1" -->
### 规范
### 案例


## 核心概念
* 资源（Resources）<!-- .element: class="fragment highlight-current-red" data-fragment-index="1" -->
* 表现（Representation）<!-- .element: class="fragment highlight-current-red" data-fragment-index="2" -->
  * XML、JSON、PNG、JPG
* 状态转化（State Transfer）<!-- .element: class="fragment highlight-current-red" data-fragment-index="3" -->
  * GET、POST、PUT、DELETE


## 实际应用
- URI 代表一种资源 <!-- .element: class="fragment highlight-current-red" data-fragment-index="1" -->
- 客户端和服务器之间，传递这种资源的某种表现 <!-- .element: class="fragment highlight-current-red" data-fragment-index="2" -->
- 通过 HTTP 对服务器端资源进行操作实现"状态转化" <!-- .element: class="fragment highlight-current-red" data-fragment-index="3" -->



### 历史
### 定义
### 规范 <!-- .element: class="fragment grow highlight-blue" data-fragment-index="1" -->
### 案例


##基本原则
* 友好, 在地址栏容易输入 <!-- .element: class="fragment highlight-current-red" data-fragment-index="2" -->
* 统一, 直观, 优雅 <!-- .element: class="fragment highlight-current-red" data-fragment-index="3" -->
* 足够的灵活性支持 UI <!-- .element: class="fragment highlight-current-red" data-fragment-index="4" -->


##专用域名

```
http://api.zackyang.com
```


##版本
```
http://api.zackyang.com/v1/
```


##路径 (URI)
名词(复数)

```
https://api.zackyang.com/v1/articles
https://api.zackyang.com/v1/articles/:id/comments
```


##HTTP Method
* GET (幂等) <!-- .element: class="fragment highlight-current-red" data-fragment-index="1" -->
* POST <!-- .element: class="fragment highlight-current-red" data-fragment-index="2" -->
* PUT <!-- .element: class="fragment highlight-current-red" data-fragment-index="3" -->
* DELETE <!-- .element: class="fragment highlight-current-red" data-fragment-index="4" -->
* PATCH <!-- .element: class="fragment highlight-current-red" data-fragment-index="5" -->
* HEAD <!-- .element: class="fragment highlight-current-red" data-fragment-index="6" -->
* OPTIONS <!-- .element: class="fragment highlight-current-red" data-fragment-index="7" -->


##HTTP Method
* GET /articles <!-- .element: class="fragment highlight-current-red" data-fragment-index="1" -->
* POST /articles <!-- .element: class="fragment highlight-current-red" data-fragment-index="2" -->
* GET /articles/:id <!-- .element: class="fragment highlight-current-red" data-fragment-index="3" -->
* PUT /articles/:id <!-- .element: class="fragment highlight-current-red" data-fragment-index="4" -->
* PATCH /articles/:id <!-- .element: class="fragment highlight-current-red" data-fragment-index="5" -->
* DELETE /articles/:id <!-- .element: class="fragment highlight-current-red" data-fragment-index="6" -->
* GET /articles/:id/comments <!-- .element: class="fragment highlight-current-red" data-fragment-index="7" -->
* DELETE /articles/:id/comments/:id <!-- .element: class="fragment highlight-current-red" data-fragment-index="8" -->


##筛选
* ?limit=10 <!-- .element: class="fragment highlight-current-red" data-fragment-index="1" -->
* ?offset=10 <!-- .element: class="fragment highlight-current-red" data-fragment-index="2" -->
* ?page=2&per_page=100 <!-- .element: class="fragment highlight-current-red" data-fragment-index="3" -->
* ?sortby=pubdate&order=asc <!-- .element: class="fragment highlight-current-red" data-fragment-index="4" -->


##状态码 (1/2)
* 200 Ok <!-- .element: class="fragment highlight-current-red" data-fragment-index="1" -->
* 201 Created <!-- .element: class="fragment highlight-current-red" data-fragment-index="2" -->
* 202 Accepted（异步） <!-- .element: class="fragment highlight-current-red" data-fragment-index="3" -->
* 204 No Content <!-- .element: class="fragment highlight-current-red" data-fragment-index="4" -->
* 304 Not Modified <!-- .element: class="fragment highlight-current-red" data-fragment-index="5" -->


##状态码 (2/2)
* 400 Invalid Request <!-- .element: class="fragment highlight-current-red" data-fragment-index="1" -->
* 401 Unauthorized <!-- .element: class="fragment highlight-current-red" data-fragment-index="2" -->
* 403 Forbidden <!-- .element: class="fragment highlight-current-red" data-fragment-index="3" -->
* 404 Not Found <!-- .element: class="fragment highlight-current-red" data-fragment-index="4" -->
* 405 Method Not Allowed <!-- .element: class="fragment highlight-current-red" data-fragment-index="5" -->
* 406 Not Acceptable <!-- .element: class="fragment highlight-current-red" data-fragment-index="6" -->
* 410 Gone <!-- .element: class="fragment highlight-current-red" data-fragment-index="7" -->
* 415 Unsupported Media Type <!-- .element: class="fragment highlight-current-red" data-fragment-index="8" -->
* 422 Unprocesable Entity <!-- .element: class="fragment highlight-current-red" data-fragment-index="9" -->
* 429 Too Many Request <!-- .element: class="fragment highlight-current-red" data-fragment-index="10" -->
* 500 Internal Server Error <!-- .element: class="fragment highlight-current-red" data-fragment-index="11" -->


##错误处理
```
{
  "code" : 1234,
  "message" : "Something bad happened :-(",
  "description" : "More details about the error here"
}
```


##错误处理
```
{
  "code" : 1024,
  "message" : "Validation Failed",
  "description" : "Some field validation failed",
  "errors" : [
    {
      "code" : 5432,
      "field" : "first_name",
      "message" : "First name cannot have fancy characters"
    },
    {
       "code" : 5622,
       "field" : "password",
       "message" : "Password cannot be blank"
    }
  ]
}
```


## 安全性
* 权限鉴定 <!-- .element: class="fragment highlight-current-red" data-fragment-index="1" -->
  * No Session
  * Cookie is optional
  * Token
  * OAuth
* 速度限制 <!-- .element: class="fragment highlight-current-red" data-fragment-index="6" -->
  * Header
    * X-Rate-Limit-Limit
    * X-Rate-Limit-Remaining
    * X-Rate-Limit-Reset
  * HTTPS


##ODATA
* filter <!-- .element: class="fragment highlight-current-red" data-fragment-index="1" -->
* action & function <!-- .element: class="fragment highlight-current-red" data-fragment-index="2" -->
* metadata generation <!-- .element: class="fragment highlight-current-red" data-fragment-index="3" -->



### 历史
### 定义
### 规范
### 案例 <!-- .element: class="fragment grow highlight-blue" data-fragment-index="1" -->


##后端框架
* .NET: [ASP.NET WEB API](http://www.asp.net/web-api)
* .NET: [ASP.NET WEB API ODATA](http://www.asp.net/web-api/overview/odata-support-in-aspnet-web-api)
* NodeJS: [Express](https://github.com/strongloop/express)
* NodeJS: [node-restify](https://github.com/mcavage/node-restify)
* NodeJS: [node-odata](https://github.com/TossShinHwa/node-odata)
* Golang: [go-restful](https://github.com/emicklei/go-restful)


## 文档编写
* [Markdown](http://wowubuntu.com/markdown/)
* [RAML](http://raml.org/)
* [YAML](http://yaml.org/) [Swagger](http://swagger.io/)


##其他
* [REST 论文(中文)](https://mysql-udf-http.googlecode.com/files/REST_cn.pdf)
* [API 设计规范参考](https://github.com/interagent/http-api-design)


##Show Time
* [services.odata.org](http://services.odata.org/v4/OData/OData.svc/Products)
* [books.zackyang.com](http://books.zackyang.com/odata/books)



##Q & A



##THE END
###By Zack Yang
